<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ToDo | <%= title %></title>
    <link rel="stylesheet" href="/style.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"
    ></script>
  </head>
  <body style="background-color: #0D0E10; color: white;">
    <nav class="navbar navbar-expand-lg bg-body-tertiary fixed-top">
      <div class="container-fluid">
        <button
          class="navbar-toggler mb-2"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarTogglerDemo01"
          aria-controls="navbarTogglerDemo01"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01" style="margin: 0 16%">
          <a class="navbar-brand h1 p-0 m-0 me-5 d-none d-lg-block" href="/">&#x2710; TODOist</a>
          <!-- removing me-auto from this ul class as didn't needed it to take the extra space -->
          <ul class="navbar-nav me-autoo mb-2 mb-lg-0">
            <li class="nav-item nav-item-width-1 me-2">
              <a class="nav-link" aria-current="page" href="/">Home</a>
            </li>
            <li class="nav-item nav-item-width-1">
              <a class="nav-link" href="/todos/add">Add</a>
            </li>
          </ul>
          <!-- adding ms-auto class in this form as needed this right form to take the space in the right -->
          <form class="d-flex ms-auto" role="search">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item nav-item-width-2 d-none" id="login">
                <a class="nav-link" href="/auth/login">Login</a>
              </li>
              <li class="nav-item nav-item-width-2 d-none" id="register">
                <a class="nav-link" href="/auth/register">Register</a>
              </li>              
              <li class="nav-item nav-item-width-3 d-none text-secondary" id="hi">
                <a class="nav-link" id="hi-anchor-tag">Hi </a>
              </li>              
              <li class="nav-item nav-item-width-2 d-none" id="logout">
                <a class="nav-link" href="/" onclick="logOut()">Logout</a>
              </li>              
            </ul>
          </form>
        </div>
      </div>
      <!-- Displayed when navbar is collapsed -->
      <ul class="navbar-nav d-lg-none" style="margin: 0 5%"> 
        <li class="nav-item">
          <a class="navbar-brand h1" href="/" style="font-size: 35px;">&#x2710; TODOist</a>
        </li>
      </ul>
    </nav>
  </body>
</html>

<script>
  window.onload = () => {
    const token = localStorage.getItem("access_token")

    if(!token){
      document.getElementById("login").classList.remove("d-none")
      document.getElementById("register").classList.remove("d-none")

      document.getElementById("logout").classList.add("d-none")
    }
    else{
      document.getElementById("logout").classList.remove("d-none")
      document.getElementById("hi").classList.remove("d-none")

      var user_name = localStorage.getItem("username")
      document.getElementById("hi-anchor-tag").innerHTML = `
      <i class="bi bi-person-fill"></i> Hi ${user_name.split(" ")[0]}  `
    }
  }
  function logOut(){
    console.log("Logging out !");
    localStorage.removeItem("access_token")
    localStorage.removeItem("username")
    document.getElementById("logout").classList.add("d-none")
  }
</script>
